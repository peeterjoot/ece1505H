%
% Copyright © 2017 Peeter Joot.  All Rights Reserved.
% Licenced as described in the file LICENSE under the root directory of this GIT repository.
%
\input{../latex/blogpost.tex}
\renewcommand{\basename}{convexOptimization4}
\renewcommand{\dirname}{notes/ece1505/}
\newcommand{\keywords}{ECE1505H}
\input{../latex/peeter_prologue_print2.tex}

\usepackage{ece1505}
\usepackage{peeters_braket}
\usepackage{peeters_layout_exercise}
\usepackage{peeters_figures}
\usepackage{mathtools}
\usepackage{siunitx}
\usepackage{macros_cal}

\beginArtNoToc
\generatetitle{ECE1505H Convex Optimization.  Lecture 4: Sets and convexity.  Taught by Prof.\ Stark Draper}
%\chapter{Sets and convexity}
\label{chap:convexOptimization4}

\paragraph{Disclaimer}

Peeter's lecture notes from class.  These may be incoherent and rough.

These are notes for the UofT course ECE1505H, Convex Optimization, taught by Prof. Stark Draper, covering \citep{boyd2004convex} content.

%\paragraph{Last time}
\paragraph{Today}

\begin{itemize}
\item more on various sets: hyperplanes, half-spaces, polyhedra, balls, ellipses, norm balls, cone of PSD
\item generalize inequalities
\item operations that preserve convexity
\item separating and supporting hyperplanes.
\end{itemize}

\section{Hyperplanes}

Find some \( \Bx_0 \in \bbR^n \) such that \( \Ba^\T \Bx_0 = \Bb \), so

\begin{dmath}\label{eqn:convexOptimizationLecture4:20}
\begin{aligned}
\setlr{ \Bx | \Ba^\T \Bx = \Bb }
&=
\setlr{ \Bx | \Ba^\T \Bx = \Ba^\T \Bx_0 } \\
&=
\setlr{ \Bx | \Ba^\T (\Bx - \Bx_0) } \\
&=
\Bx_0 + \Ba^\perp,
\end{aligned}
\end{dmath}

where

\begin{equation}\label{eqn:convexOptimizationLecture4:40}
\Ba^\perp = \setlr{ \Bv | \Ba^\T \Bv = 0 }.
\end{equation}

%F1
%\cref{fig:l4:l4Fig1}.
\imageFigure{../figures/ece1505-convex-optimization/l4Fig1}{CAPTION: l4Fig1}{fig:l4:l4Fig1}{0.2}

Recall

\begin{equation}\label{eqn:convexOptimizationLecture4:60}
\Norm{\Bz}_\conj = \sup_\Bx \setlr{ \Bz^\T \Bx | \Norm{\Bx} \le 1 }
\end{equation}

Denote the optimizer of above as \( \Bx^\conj \).  By definition

\begin{equation}\label{eqn:convexOptimizationLecture4:80}
\Bz^\T \Bx^\conj \ge \Bz^\T \Bx \quad \forall \Bx, \Norm{\Bx} \le 1
\end{equation}

This defines a half space in which the unit ball

\begin{equation}\label{eqn:convexOptimizationLecture4:100}
\setlr{ \Bx | \Bz^\T (\Bx - \Bx^\conj \le 0 }
\end{equation}

Start with the \( l_1 \) norm, duals of \( l_1 \) is \( l_\infty \)

%F2
%\cref{fig:l4HalfspaceContiningUnitBall:l4HalfspaceContiningUnitBallFig2}.
\imageFigure{../figures/ece1505-convex-optimization/l4HalfspaceContiningUnitBallFig2}{CAPTION: l4HalfspaceContiningUnitBallFig2}{fig:l4HalfspaceContiningUnitBall:l4HalfspaceContiningUnitBallFig2}{0.2}

Similar pic for \( l_\infty \), for which the dual is the \( l_1 \) norm, as sketched in
\cref{fig:l4LinfinityUnitBallHalfSpace:l4LinfinityUnitBallHalfSpaceFig3}.
Here the optimizer point is at \( (1,1) \)

\imageFigure{../figures/ece1505-convex-optimization/l4LinfinityUnitBallHalfSpaceFig3}{CAPTION: l4LinfinityUnitBallHalfSpaceFig3}{fig:l4LinfinityUnitBallHalfSpace:l4LinfinityUnitBallHalfSpaceFig3}{0.2}

and a similar pic for \( l_2 \), which is sketched in \cref{fig:l4L2unitballhalfplane:l4L2unitballhalfplaneFig4}.

\imageFigure{../figures/ece1505-convex-optimization/l4L2unitballhalfplaneFig4}{CAPTION: l4L2unitballhalfplaneFig4}{fig:l4L2unitballhalfplane:l4L2unitballhalfplaneFig4}{0.2}

Q: What was this optimizer point?

\section{Polyhedra}

\begin{equation}\label{eqn:convexOptimizationLecture4:120}
\calP = \setlr{ \Bx |
\Ba_j^\T \Bx \le \Bb_j, j \in [1,m],
\Bc_i^\T \Bx = \Bd_i, i \in [1,p]
}
=
\setlr{ \Bx | A \Bx \le \Bb, C \Bx = d },
\end{equation}

where the final inequality and equality are component wise.

Proving \( \calP \) is convex:

\begin{itemize}
\item Pick \(\Bx_1 \in \calP\), \(\Bx_2 \in \calP \)
\item Pick any \(\theta \in [0,1]\)
\item Test \( \theta \Bx_1 + (1-\theta) \Bx_2 \).  Is it in \(\calP\)?
\end{itemize}

\begin{dmath}\label{eqn:convexOptimizationLecture4:140}
A \lr{ \theta \Bx_1 + (1-\theta) \Bx_2 }
=
\theta A \Bx_1 + (1-\theta) A \Bx_2
\le
\theta \Bb + (1-\theta) \Bb
=
\Bb.
\end{dmath}

\section{Balls}

Euclidean ball for \( \Bx_c \in \bbR^n, r \in \bbR \)

\begin{equation}\label{eqn:convexOptimizationLecture4:160}
\calB(\Bx_c, r)
= \setlr{ \Bx | \Norm{\Bx - \Bx_c}_2 \le r },
\end{equation}

or
\begin{equation}\label{eqn:convexOptimizationLecture4:180}
\calB(\Bx_c, r)
= \setlr{ \Bx | \lr{\Bx - \Bx_c}^\T \lr{\Bx - \Bx_c} \le r^2 }.
\end{equation}

Let \( \Bx_1, \Bx_2 \), \(\theta \in [0,1]\)

\begin{dmath}\label{eqn:convexOptimizationLecture4:200}
\Norm{ \theta \Bx_1 + (1-\theta) \Bx_2 - \Bx_c }_2
=
\Norm{ \theta (\Bx_1 - \Bx_c) + (1-\theta) (\Bx_2 - \Bx_c) }_2
\le
\Norm{ \theta (\Bx_1 - \Bx_c)}_2 + \Norm{(1-\theta) (\Bx_2 - \Bx_c) }_2
=
\Abs{\theta} \Norm{ \Bx_1 - \Bx_c}_2 + \Abs{1 -\theta} \Norm{ \Bx_2 - \Bx_c }_2
=
\theta \Norm{ \Bx_1 - \Bx_c}_2 + \lr{1 -\theta} \Norm{ \Bx_2 - \Bx_c }_2
\le
\theta r + (1 - \theta) r
= r
\end{dmath}

\section{Ellipse}

\begin{equation}\label{eqn:convexOptimizationLecture4:220}
\calE(\Bx_c, P)
=
\setlr{ \Bx | (\Bx - \Bx_c)^\T P^{-1} (\Bx - \Bx_c) \le 1 },
\end{equation}

where \( P \in S^n_{++} \).

\begin{itemize}
\item Euclidean ball is an ellipse with \( P = I r^2 \)
\item Ellipse is image of Euclidean ball \( \calB(0,1) \) under affine mapping.
\end{itemize}

%\cref{fig:l4CircleAndEllipse:l4CircleAndEllipseFig5}.
\imageFigure{../figures/ece1505-convex-optimization/l4CircleAndEllipseFig5}{CAPTION: l4CircleAndEllipseFig5}{fig:l4CircleAndEllipse:l4CircleAndEllipseFig5}{0.2}

Given

\begin{dmath}\label{eqn:convexOptimizationLecture4:240}
F(\Bu) = P^{1/2} \Bu + \Bx_c
\end{dmath}

\begin{dmath}\label{eqn:convexOptimizationLecture4:260}
\begin{aligned}
\setlr{ F(\Bu) | \Norm{\Bu}_2 \le r }
&=
\setlr{ P^{1/2} \Bu + \Bx_c | \Bu^\T \Bu \le r^2 } \\
&=
\setlr{ \Bx | \Bx = P^{1/2} \Bu + \Bx_c, \Bu^\T \Bu \le r^2 } \\
&=
\setlr{ \Bx | \Bu = P^{-1/2} (\Bx - \Bx_c), \Bu^\T \Bu \le r^2 } \\
&=
\setlr{ \Bx | (\Bx - \Bx_c)^\T P^{-1} (\Bx - \Bx_c) \le r^2 }
\end{aligned}
\end{dmath}

\section{Geometry of an ellipse}

%\succeq
Decomposition of positive definite matrix \( P \in S^n_{++} \subset S^n \) is:

\begin{dmath}\label{eqn:convexOptimizationLecture4:280}
\begin{aligned}
P &= Q \diag(\lambda_i) Q^\T \\
Q^\T Q &= 1
\end{aligned},
\end{dmath}

where \( \lambda_i \in \bbR\), and \(\lambda_i > 0 \).

The ellipse is defined by

\begin{equation}\label{eqn:convexOptimizationLecture4:300}
(\Bx - \Bx_c)^\T Q \diag(1/\lambda_i) (\Bx - \Bx_c) Q \le r^2
\end{equation}

The term \( (\Bx - \Bx_c)^\T Q \) projects \( \Bx - \Bx_c \) onto the columns of \( Q \).  Those columns are perpendicular since \( Q \) is an orthogonal matrix.

Let

\begin{equation}\label{eqn:convexOptimizationLecture4:320}
\tilde{\Bx} = Q^\T (\Bx - \Bx_c),
\end{equation}

this shifts the origin around \( \Bx_c \) and \( Q \) rotates into a new coordinate system.

The ellipse is therefore

\begin{equation}\label{eqn:convexOptimizationLecture4:340}
\tilde{\Bx}^\T
\begin{bmatrix}
\inv{\lambda_1} &                &        & \\
                &\inv{\lambda_2} &        & \\
                                 & \ddots & \\
                &                &        & \inv{\lambda_n}
\end{bmatrix}
\tilde{\Bx}
=
\sum_{i = 1}^n \frac{\tilde{x}_i^2}{\lambda_i} \le 1.
\end{equation}

An example is sketched for \( \lambda_1 > \lambda_2 \) in \cref{fig:l4EllipseGeometry:l4EllipseGeometryFig6Lambda1gtLambda2}.
\imageFigure{../figures/ece1505-convex-optimization/l4EllipseGeometryFig6Lambda1gtLambda2}{Ellipse with \( \lambda_1 > \lambda_2 \).}{fig:l4EllipseGeometry:l4EllipseGeometryFig6Lambda1gtLambda2}{0.2}

\begin{itemize}
\item \( \lambda_i \) tells us length of the semi-major axis.
\item Larger \( \lambda_i \) means \( \tilde{x}_i^2 \) can be bigger and still satisfy constraint \( \le 1 \).
\item Volume of ellipse if proportional to \( \sqrt{ \det P } = \sqrt{ \prod_{i = 1}^n \lambda_i } \).
\item When any \( \lambda_i \rightarrow 0 \) a dimension is lost and the volume goes to zero.  That removes the invertibility required.
\end{itemize}

Ellipses will be seen a lot in this course, since we are interested in ``bowl'' like geometries (and the ellipse is the image of a Euclidean ball).

\section{Norm ball.}

The norm ball

\begin{equation}\label{eqn:convexOptimizationLecture4:360}
\calB = \setlr{ \Bx | \Norm{\Bx} \le 1 },
\end{equation}

is a convex set for all norms.  Proof:

Take any \( \Bx, \By \in \calB \)

\begin{dmath}\label{eqn:convexOptimizationLecture4:380}
\Norm{ \theta \Bx + (1 - \theta) \By }
\le
\Abs{\theta} \Norm{ \Bx } + \Abs{1 - \theta} \Norm{ \By }
=
\theta \Norm{ \Bx } + \lr{1 - \theta} \Norm{ \By }
\lr
\theta + \lr{1 - \theta}
=
1.
\end{dmath}

This is true for any p-norm \( 1 \le p \), \( \Norm{\Bx}_p = \lr{ \sum_{i = 1}^n \Abs{x_i}^p }^{1/p} \).

%F7
%\cref{fig:l4:l4Fig7Pge1}.
\imageFigure{../figures/ece1505-convex-optimization/l4Fig7Pge1}{CAPTION: l4Fig7Pge1}{fig:l4:l4Fig7Pge1}{0.2}

The shape of a \( p < 1 \) norm unit ball is sketched in \cref{fig:l4PlessThan1:l4PlessThan1Fig7b} (lines connecting points in such a region can exit the region).

%\imageFigure{../figures/ece1505-convex-optimization/l4PlessThan1Fig7b}{CAPTION: l4PlessThan1Fig7b}{fig:l4PlessThan1:l4PlessThan1Fig7b}{0.2}
\imageFigure{../figures/ece1505-convex-optimization/l4PNormPLessThan1Fig7b}{Unit ball for \( l_{0.6} \) ``p-norm''.}{fig:l4PlessThan1:l4PlessThan1Fig7b}{0.2}

\section{Cones}

Recall that \( C \) is a cone if \( \forall \Bx \in C, \theta \ge 0, \theta \Bx \in C \).

Impt cone of PSD matrices

\begin{dmath}\label{eqn:convexOptimizationLecture4:400}
\begin{aligned}
S^n &= \setlr{ X \in \bbR^{n \times n} | X = X^\T } \\
S^n_{+} &= \setlr{ X \in S^n | \Bv^\T X \Bv \ge 0, \quad \forall v \in \bbR^n } \\
S^n_{++} &= \setlr{ X \in S^n_{+} | \Bv^\T X \Bv > 0, \quad \forall v \in \bbR^n } \\
\end{aligned}
\end{dmath}

These have respectively

\begin{itemize}
\item \( \lambda_i \in \bbR \)
\item \( \lambda_i \in \bbR_{+} \)
\item \( \lambda_i \in \bbR_{++} \)
\end{itemize}

\( S^n_{+} \) is a cone if:

\( X \in S^n_{+}\), then \( \theta X \in S^n_{+}, \quad \forall \theta \ge 0 \)

\begin{dmath}\label{eqn:convexOptimizationLecture4:420}
\Bv^\T (\theta X) \Bv
= \theta \Bv^\T \Bv
\ge 0,
\end{dmath}

since \( \theta \ge 0 \) and because \( X \in S^n_{+} \).

Shorthand:

% succeq: curly \ge
\begin{dmath}\label{eqn:convexOptimizationLecture4:440}
\begin{aligned}
X &\in S^n_{+} \implies X \succeq 0
X &\in S^n_{++} \implies X \succ 0.
\end{aligned}
\end{dmath}

Further \( S^n_{+} \) is a convex cone.

Let \( A \in S^n_{+} \), \( B \in S^n_{+} \), \( \theta_1, \theta_2 \ge 0, \theta_1 + \theta_2 = 1 \), or \( \theta_2 = 1 - \theta_1 \).

Show that \( \theta_1 A + \theta_2 B \in S^n_{+} \) :

\begin{dmath}\label{eqn:convexOptimizationLecture4:460}
\Bv^\T \lr{  \theta_1 A + \theta_2 B } \Bv
=
\theta_1 \Bv^\T A \Bv
+\theta_2 \Bv^\T B \Bv
\ge 0,
\end{dmath}

since \( \theta_1 \ge 0, \theta_2 \ge 0, \Bv^\T A \Bv \ge 0, \Bv^\T B \Bv \ge 0 \).

%F8
%\cref{fig:l4cone:l4coneFig8}.
\imageFigure{../figures/ece1505-convex-optimization/l4coneFig8}{CAPTION: l4coneFig8}{fig:l4cone:l4coneFig8}{0.2}

Inequalities:

Start with a proper cone \( K \subseteq \bbR^n \)

\begin{itemize}
\item closed, convex
\item non-empty interior (``solid'')
\item ``pointed'' (contains no lines)
\end{itemize}

%F9
%\cref{fig:l4cone:l4coneFig9}.
\imageFigure{../figures/ece1505-convex-optimization/l4coneFig9}{CAPTION: l4coneFig9}{fig:l4cone:l4coneFig9}{0.2}

The \( K \) defines a generalized inequality in \R{n} defined as ``\(\le_K\)''

Interpreting

\begin{dmath}\label{eqn:convexOptimizationLecture4:480}
\begin{aligned}
\Bx \le_K \By &\leftrightarrow \By - \Bx \in K
\Bx <_K \By   &\leftrightarrow \By - \Bx \in \interior K
\end{aligned}
\end{dmath}

%F10
%\cref{fig:l4Cone:l4ConeFig10a}.
\imageFigure{../figures/ece1505-convex-optimization/l4ConeFig10a}{CAPTION: l4ConeFig10a}{fig:l4Cone:l4ConeFig10a}{0.2}
%\cref{fig:l4inequalityK:l4inequalityKFig10b}.
\imageFigure{../figures/ece1505-convex-optimization/l4inequalityKFig10b}{CAPTION: l4inequalityKFig10b}{fig:l4inequalityK:l4inequalityKFig10b}{0.2}

Why pointed?  Want if \( \Bx \le_K \By \) and \( \By \le_K \Bx \) with this \( K \) is a half space.

%F11
%\cref{fig:l4region:l4regionFig11}.
\imageFigure{../figures/ece1505-convex-optimization/l4regionFig11}{CAPTION: l4regionFig11}{fig:l4region:l4regionFig11}{0.2}

Example:1: \( K = \bbR^n_{+}, \Bx \in \bbR^n, \By \in \bbR^n \)

%F12: K is non-negative ``orthant''.
%\cref{fig:l4:l4Fig12}.
\imageFigure{../figures/ece1505-convex-optimization/l4Fig12}{\(K\) is non-negative ``orthant''}{fig:l4:l4Fig12}{0.2}

\begin{equation}\label{eqn:convexOptimizationLecture4:500}
\Bx \le_K \By \implies \By - \Bx \in K
\end{equation}

say:

\begin{dmath}\label{eqn:convexOptimizationLecture4:520}
\begin{bmatrix}
y_1 - x_1
y_2 - x_2
\end{bmatrix}
\in R^2_{+}
\end{dmath}

Also:

\begin{dmath}\label{eqn:convexOptimizationLecture4:540}
K = R^1_{+}
\end{dmath}

%F13
%\cref{fig:l4:l4Fig13}.
\imageFigure{../figures/ece1505-convex-optimization/l4Fig13}{CAPTION: l4Fig13}{fig:l4:l4Fig13}{0.2}

(pointed, since it contains no rays)

\begin{equation}\label{eqn:convexOptimizationLecture4:560}
\Bx \le_K \By ,
\end{equation}

with respect to \( K = \bbR^n_{+} \) means that \( x_i \le y_i \) for all \( i \in [1,n]\).

Example:2: For \( K = PSD \subseteq S^n \),

\begin{equation}\label{eqn:convexOptimizationLecture4:580}
\Bx \le_K \By ,
\end{equation}

means that

\begin{equation}\label{eqn:convexOptimizationLecture4:600}
\By - \Bx \in K = S^n_{+}.
\end{equation}

\begin{itemize}
\item Difference \( \By - \Bx \) is always in \( S \)
\item check if in \( K \) by checking if all eigenvalues \( \ge 0 \).
\item \( S^n_{++} \) is the interior of \( S^n_{+} \).
\end{itemize}

Interpretation:

\begin{equation}\label{eqn:convexOptimizationLecture4:620}
\begin{aligned}
\Bx \le_K \By &\leftrightarrow \By - \Bx \in K \\
\Bx <_K \By   &\leftrightarrow \By - \Bx \in \interior K.
\end{aligned}
\end{equation}

We'll use these with vectors and matrices so often the \( K \) subscript will often be dropped, writing instead (for vectors)

\begin{equation}\label{eqn:convexOptimizationLecture4:640}
\begin{aligned}
\Bx \le \By &\leftrightarrow \By - \Bx \in \bbR^n_{+} \\
\Bx < \By   &\leftrightarrow \By - \Bx \in \interior \bbR^n_{++}
\end{aligned}
\end{equation}

and for matrices

\begin{equation}\label{eqn:convexOptimizationLecture4:660}
\begin{aligned}
\Bx \le \By &\leftrightarrow \By - \Bx \in S^n_{+} \\
\Bx < \By   &\leftrightarrow \By - \Bx \in \interior S^n_{++}.
\end{aligned}
\end{equation}

\section{Intersection}

Take the intersection of (perhaps infinitely many) sets \( S_\alpha \):

If \( S_\alpha \) is (affine,convex, conic) for all \( \alpha \in A \) then

%(upside down U)
\begin{dmath}\label{eqn:convexOptimizationLecture4:680}
\cap_\alpha S_\alpha
\end{dmath}

is

(affine,convex, conic).

To prove in homework:

\begin{equation}\label{eqn:convexOptimizationLecture4:700}
\calP = \setlr{ \Bx | \Ba_i^\T \Bx \le \Bb_i, \Bc_j^\T \Bx = \Bd_j, \quad \forall i \cdots j }
\end{equation}

This is convex since the intersection of a bunch of hyperplane and half space constraints.

\begin{enumerate}
\item If \( S \subseteq \bbR^n \) is convex then

\begin{equation}\label{eqn:convexOptimizationLecture4:720}
F(S) = \setlr{ F(\Bx) | \Bx \in S }
\end{equation}

is convex.
\item If \( S \subseteq \bbR^m \) then

\begin{equation}\label{eqn:convexOptimizationLecture4:740}
F^{-1}(S) = \setlr{ \Bx | F(\Bx) \in S }
\end{equation}

is convex.
\end{enumerate}

%F14
%\cref{fig:l4:l4Fig14}.
\imageFigure{../figures/ece1505-convex-optimization/l4Fig14}{CAPTION: l4Fig14}{fig:l4:l4Fig14}{0.2}

\EndArticle
%\EndNoBibArticle
